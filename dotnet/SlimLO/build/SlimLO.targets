<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!--
    SlimLO.targets â€” Copies native runtime assets to the output directory.

    The SlimLO.Native.{rid} NuGet packages place native libraries under
    runtimes/{rid}/native/. This targets file ensures they get copied to the
    application's output directory at build time, including the worker binary
    and share/ resources (XCD config, filter definitions).

    For consumers:
      Install SlimLO + SlimLO.Native.linux-x64 (or your platform).
      Native files will be copied to your bin/ automatically.
  -->
  <PropertyGroup>
    <SlimLORuntimeDir Condition="'$(SlimLORuntimeDir)' == ''">$(NuGetPackageRoot)slimlo.native.$(RuntimeIdentifier)\$(SlimLONativeVersion)\runtimes\$(RuntimeIdentifier)\native\</SlimLORuntimeDir>
  </PropertyGroup>

  <ItemGroup Condition="Exists('$(SlimLORuntimeDir)')">
    <!-- Copy all native libraries -->
    <None Include="$(SlimLORuntimeDir)*.so" CopyToOutputDirectory="PreserveNewest" Link="%(Filename)%(Extension)" />
    <None Include="$(SlimLORuntimeDir)*.so.*" CopyToOutputDirectory="PreserveNewest" Link="%(Filename)%(Extension)" />
    <None Include="$(SlimLORuntimeDir)*.dylib" CopyToOutputDirectory="PreserveNewest" Link="%(Filename)%(Extension)" />
    <None Include="$(SlimLORuntimeDir)*.dll" CopyToOutputDirectory="PreserveNewest" Link="%(Filename)%(Extension)" />
    <!-- Copy worker executable -->
    <None Include="$(SlimLORuntimeDir)slimlo_worker" Condition="Exists('$(SlimLORuntimeDir)slimlo_worker')" CopyToOutputDirectory="PreserveNewest" Link="slimlo_worker" />
    <None Include="$(SlimLORuntimeDir)slimlo_worker.exe" Condition="Exists('$(SlimLORuntimeDir)slimlo_worker.exe')" CopyToOutputDirectory="PreserveNewest" Link="slimlo_worker.exe" />
    <!-- Copy UNO registries and config -->
    <None Include="$(SlimLORuntimeDir)*.rdb" CopyToOutputDirectory="PreserveNewest" Link="%(Filename)%(Extension)" />
    <None Include="$(SlimLORuntimeDir)*rc" CopyToOutputDirectory="PreserveNewest" Link="%(Filename)%(Extension)" />
    <None Include="$(SlimLORuntimeDir)*.ini" CopyToOutputDirectory="PreserveNewest" Link="%(Filename)%(Extension)" />
    <!-- Copy share/ resources -->
    <None Include="$(SlimLORuntimeDir)share\**" CopyToOutputDirectory="PreserveNewest" Link="share\%(RecursiveDir)%(Filename)%(Extension)" />
  </ItemGroup>
</Project>
